### 2.1 什么是分布式互斥
想象一下，你正在一家餐厅使用自助咖啡机泡制咖啡，突然有个人过来挪走了你的杯子，开始泡制他自己的咖啡。你耐着性子等他操作完，继续泡
制自己的咖啡。结果你开始没多久，他又回来中断了你泡制咖啡的过程。相信要不了几个回合，你和他就会上演一场“有你没我，有我没你”的格斗了。

这样现实的问题也同样存在于分布式世界。就像我们使用自助咖啡机时不希望被打扰一样，对于同一共享资源，一个程序正在使用的时候也不希
望被其他程序打扰。这，就要求同一时刻只能有一个程序能够访问这种资源。  

在分布式系统里，这种排他性的资源访问方式，叫作`分布式互斥（Distributed Mutual Exclusion），而这种被互斥访问的共享资源就叫作
临界资源（Critical Resource）。`

+ 霸道总裁：集中式算法
对于前面提到的咖啡机问题，我们首先想到的就是，增加一个“协调者”来约束大家使用自助咖啡机，解决强行插入打断别人的问题。  

类似地，我们引入一个协调者程序，得到一个分布式互斥算法。每个程序在需要访问临界资源时，先给协调者发送一个请求。如果当前没有程序使
用这个资源，协调者直接授权请求程序访问；否则，按照先来后到的顺序为请求程序“排一个号”。如果有程序使用完资源，则通知协调者，协调者
从“排号”的队列里取出排在最前面的请求，并给它发送授权消息。拿到授权消息的程序，可以直接去访问临界资源。  

这个互斥算法，就是我们所说的`集中式算法`，也可以叫做中央服务器算法。之所以这么称呼，是因为协调者代表着集中程序或中央服务器。

一个程序完成一次临界资源访问，需要如下几个流程和消息交互：  
1 向协调者发送请求授权信息，1 次消息交互；  
2 协调者向程序发放授权信息，1 次消息交互；  
3 程序使用完临界资源后，向协调者发送释放授权，1 次消息交互。  

算法缺陷： 这个算法的问题也出在了协调者身上。一方面，协调者会成为系统的性能瓶颈。另一方面，容易引发单点故障问题,协调者故障，会导致所有的程序均无法访问临界资源，导致整个系统不可用。  
因此，`在使用集中式算法的时候，一定要选择性能好、可靠性高的服务器来运行协调者。`